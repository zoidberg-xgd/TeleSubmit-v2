# 🧪 TeleSubmit v2 测试指南

部署完成后，请按照此指南测试所有功能。

---

## 📋 测试清单

### ✅ 阶段 1：基础功能测试

#### 1.1 启动测试

```
操作：在 Telegram 中找到您的机器人
预期：能够找到并打开对话
```

#### 1.2 /start 命令

```
发送：/start

预期输出：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
👋 欢迎使用 [频道名称] 投稿机器人！

🎯 功能简介：
• 📝 投稿管理 - /submit
• 🔍 搜索功能 - /search
• 📊 统计分析 - /stats
• 🏷️ 标签系统 - /tags

💡 发送 /help 查看所有命令
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

状态：[ ] 通过 [ ] 失败
```

#### 1.3 /help 命令

```
发送：/help

预期输出：显示所有可用命令和说明

状态：[ ] 通过 [ ] 失败
```

#### 1.4 /cancel 命令

```
发送：/cancel

预期输出：
当前没有进行中的操作。

状态：[ ] 通过 [ ] 失败
```

---

### ✅ 阶段 2：投稿功能测试

#### 2.1 开始投稿

```
发送：/submit

预期输出：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 开始投稿

请发送您要投稿的内容：
• 文字消息
• 图片（可配文字）
• 视频（可配文字）
• 文档

💡 发送 /cancel 可取消投稿
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

状态：[ ] 通过 [ ] 失败
```

#### 2.2 发送文字内容

```
操作：发送一段测试文字
例如：这是一条测试投稿

预期输出：显示预览和标签输入提示

状态：[ ] 通过 [ ] 失败
```

#### 2.3 添加标签

```
操作：发送标签
例如：#测试 #功能测试

预期输出：显示最终预览和确认按钮

状态：[ ] 通过 [ ] 失败
```

#### 2.4 发布到频道

```
操作：点击 [✅ 发布] 按钮

预期结果：
1. 机器人回复：✅ 投稿已发布！
2. 内容出现在频道中
3. 包含正确的文字和标签

状态：[ ] 通过 [ ] 失败
```

#### 2.5 测试图片投稿

```
操作：
1. /submit
2. 发送一张图片（可带文字说明）
3. 添加标签：#图片测试
4. 点击发布

预期：图片成功发布到频道

状态：[ ] 通过 [ ] 失败
```

#### 2.6 测试视频投稿

```
操作：
1. /submit
2. 发送一个视频
3. 添加标签：#视频测试
4. 点击发布

预期：视频成功发布到频道

状态：[ ] 通过 [ ] 失败
```

#### 2.7 测试文档投稿

```
操作：
1. /submit
2. 发送一个文档（PDF、Word等）
3. 添加标签：#文档测试
4. 点击发布

预期：文档成功发布到频道

状态：[ ] 通过 [ ] 失败
```

---

### ✅ 阶段 3：搜索功能测试

#### 3.1 关键词搜索

```
发送：/search 测试

预期输出：
🔍 搜索结果：测试

找到 X 条相关投稿：

1️⃣ [投稿标题/内容预览]
   👤 投稿人 | 📅 日期 | 👀 X 次查看
   🏷️ #标签

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 点击消息链接查看完整内容

状态：[ ] 通过 [ ] 失败
```

#### 3.2 标签搜索

```
发送：/search #测试

预期输出：显示所有带 #测试 标签的投稿

状态：[ ] 通过 [ ] 失败
```

#### 3.3 查看标签云

```
发送：/tags

预期输出：
🏷️ 标签云

热门标签：
#测试 (X 次使用)
#功能测试 (X 次使用)
#图片测试 (X 次使用)
...

💡 使用 /search #标签 搜索该标签

状态：[ ] 通过 [ ] 失败
```

#### 3.4 无结果搜索

```
发送：/search 不存在的关键词xyz

预期输出：
🔍 搜索结果：不存在的关键词xyz

未找到相关投稿。

💡 提示：
• 尝试使用不同的关键词
• 使用 /tags 查看可用标签

状态：[ ] 通过 [ ] 失败
```

---

### ✅ 阶段 4：个人功能测试

#### 4.1 查看我的投稿

```
发送：/myposts

预期输出：
📝 我的投稿

您共有 X 条投稿：

1️⃣ [投稿内容预览]
   📅 发布时间 | 👀 X 次查看
   🏷️ #标签

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

状态：[ ] 通过 [ ] 失败
```

#### 4.2 查看个人统计

```
发送：/mystats

预期输出：
📊 个人统计

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 投稿统计
  • 总投稿数：X 条
  • 本周投稿：X 条
  • 本月投稿：X 条

👀 浏览统计
  • 总浏览量：X 次
  • 平均浏览：X 次/条
  • 最高浏览：X 次

🏷️ 标签使用
  • 常用标签：#xxx, #xxx
  • 标签总数：X 个

状态：[ ] 通过 [ ] 失败
```

---

### ✅ 阶段 5：热度排行测试

#### 5.1 查看热门投稿

```
发送：/hot

预期输出：
🔥 热门投稿排行

📊 近 7 天热门：

1️⃣ [投稿内容]
   👀 X 次查看 | 📅 发布时间
   🏷️ #标签

2️⃣ ...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

状态：[ ] 通过 [ ] 失败
```

#### 5.2 测试浏览量统计

```
操作：
1. 多次点击频道中的投稿链接
2. 再次运行 /hot 和 /mystats

预期：浏览量数字增加

状态：[ ] 通过 [ ] 失败
```

---

### ✅ 阶段 6：管理功能测试（仅所有者）

#### 6.1 全站统计

```
发送：/stats

预期输出（仅所有者可见）：
📊 全站统计

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 投稿统计
  • 总投稿数：X 条
  • 今日新增：X 条
  • 本周新增：X 条

👥 用户统计
  • 活跃用户：X 人
  • 新用户（本周）：X 人

👀 浏览统计
  • 总浏览量：X 次
  • 今日浏览：X 次

🏷️ 标签统计
  • 标签总数：X 个
  • 热门标签：#xxx (#xxx...)

状态：[ ] 通过 [ ] 失败 [ ] N/A（非所有者）
```

#### 6.2 黑名单管理

```
发送：/blacklist

预期输出（仅所有者可见）：
🚫 黑名单管理

当前黑名单：
[空] 或 [用户列表]

💡 使用 /blacklist add <user_id> 添加
   使用 /blacklist remove <user_id> 移除

状态：[ ] 通过 [ ] 失败 [ ] N/A（非所有者）
```

---

## 🔧 故障排查

### 问题 1：机器人无响应

**检查步骤：**
```bash
# 1. 检查配置
python3 check_config.py

# 2. 查看日志（Docker）
docker-compose logs -f

# 3. 查看日志（直接运行）
# 查看控制台输出或 logs/bot.log
```

**常见原因：**
- Token 错误
- 网络连接问题
- 服务未启动

---

### 问题 2：无法发布到频道

**检查清单：**
- [ ] 机器人是否为频道管理员？
- [ ] 机器人是否有「发布消息」权限？
- [ ] 频道 ID 是否正确？
- [ ] 格式是否正确（@username 或 -100xxx）？

---

### 问题 3：搜索功能不工作

**解决方案：**
```bash
# 重建搜索索引
python3 migrate_to_search.py

# 或在 Docker 中
docker-compose exec telesubmit python3 migrate_to_search.py
```

---

### 问题 4：统计数据不准确

**原因：**
- 搜索索引未同步
- 数据库需要重建索引

**解决：**
```bash
# 运行迁移脚本
python3 migrate_to_search.py
```

---

## 📊 测试报告模板

### 环境信息
- **部署方式**：[ ] Docker [ ] 直接运行
- **Python 版本**：_________
- **操作系统**：_________
- **测试日期**：_________

### 测试结果统计

| 测试阶段 | 通过 | 失败 | 备注 |
|---------|------|------|------|
| 基础功能 | __/4 | __/4 | |
| 投稿功能 | __/7 | __/7 | |
| 搜索功能 | __/4 | __/4 | |
| 个人功能 | __/2 | __/2 | |
| 热度排行 | __/2 | __/2 | |
| 管理功能 | __/2 | __/2 | |
| **总计** | __/21 | __/21 | |

### 发现的问题

1. 
2. 
3. 

### 改进建议

1. 
2. 
3. 

---

## ✅ 完成测试后

**如果所有测试通过：**
🎉 恭喜！您的机器人已经完全就绪！

**如果有测试失败：**
1. 查看上面的故障排查部分
2. 运行 `python3 check_config.py` 诊断
3. 查看日志寻找错误信息
4. 参考 DEPLOY_GUIDE.md 中的故障排查章节

---

**祝测试顺利！** 🚀

如有问题，请查看：
- [DEPLOY_GUIDE.md](DEPLOY_GUIDE.md) - 详细故障排查
- [EASY_START.md](EASY_START.md) - 常见问题解答
- 运行 `python3 check_config.py` - 配置诊断

